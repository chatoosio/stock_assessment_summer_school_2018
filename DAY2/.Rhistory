library(spict)
setwd("~/stock_assessment_summer_school_2018/DAY2")
ane <- read.csv("ANE_06_nonAge.csv")
View(ane)
ane6 <- vector("list")
ane6
ane6 <- vector("list")
# Import Catch data (Landings plus Discards)
ane6$obsC  <- ane$catch  #catch observations
ane6$timeC <- ane$year   # time of catch observations
ane6$obsC <- c(ane6$obsC, 17830.4) # adding an extra value to update the stock
ane6$timeC <- c(ane6$timeC, 2016)  # adding an extra value to update the year
# TUNING INDEXES
# Pick surveys index, in this case an acoustic biomass index
ane6$timeI <- ane$year[59:71] # Index 1
ane6$obsI <- ane$index[59:71]
ane6$obsI <- c(ane6$obsI, 67910.3)
ane6$timeI <- c(ane6$timeI, 2016)
# Inspect the file
ane6
is(ane6)
plotspict.data(ane6) # Notice color coding of the month!
plotspict.ci(ane6)
ane6fit <- fit.spict(ane6)
summary(ane6fit)
ane6fit_diagn <- calc.osa.resid(ane6fit)
plotspict.diagnostic(ane6fit_diagn)
ane6fit_retro <- retro(ane6fit, nretroyear = 4)
# now plot it!
plotspict.retro(ane6fit_retro)
ane6 <- vector("list")
# Import Catch data (Landings plus Discards)
ane6$obsC  <- ane$catch  #catch observations
ane6$timeC <- ane$year   # time of catch observations
ane6$obsC <- c(ane6$obsC, 17830.4) # adding an extra value to update the stock
ane6$timeC <- c(ane6$timeC, 2016)  # adding an extra value to update the year
# TUNING INDEXES
ane6$timeI <- ane$year[59:71] # Index 1
ane6$obsI <- ane$index[59:71]
ane6$obsI <- c(ane6$obsI, 67910.3)
ane6$timeI <- c(ane6$timeI, 2016)
ane6$timeI[1:5] <- ane6$timeI[1:5] + 0.95
ane6$timeI[6:14] <- ane6$timeI[6:14] + 0.54
ane6$eulertype = "soft"
# how does it look?
plotspict.data(ane6)
ne6fitTA <- fit.spict(ane6)
capture.output(summary(ne6fitTA))[1:4]
#Check list:
#  - did it converge?
#  - how is it fitting?
# Let's have a look at the Diagnostics First
ane6fitTA_diagn <- calc.osa.resid(ne6fitTA)
plotspict.diagnostic(ane6fitTA_diagn)
# Diagnostics, run it by taking away the last 4 years, one at a time
ane6fitTA_retro <- retro(ne6fitTA, nretroyear = 4)
plotspict.retro(ane6fitTA_retro)
library(ggplot2)
library(plyr)
library(spict)
library(reshape2)
library(data.table)
lands17_18 = fread("landings17_18.csv")
names(lands17_18) = c("year","landings")
# look at the file, what do we have there?
View(lands17_18)
MEDITS = fread("MEDITS17_18.csv")
names(MEDITS)=c("index","year")
nep_pomo=fread("nep_pomo.csv")
froglia=fread("froglia.csv")
nep1718 <- vector("list")
# Import Catch data (basically only landings because there isn't discard for this species)
nep1718$obsC  <- lands17_18$landings #catch observations
nep1718$timeC <- lands17_18$year # time of catch observations
# TUNING INDEXES
# Pick surveys index, in this case an trawl survey biomass index (MEDITS)
nep1718$obsI <- list()
nep1718$obsI[[1]] <- froglia$kh_hour_m
nep1718$obsI[[2]] <- nep_pomo$CPUE_NEP_Combined
nep1718$obsI[[3]] <- MEDITS$index[MEDITS$year > 1993]
nep1718$timeI <- list()
nep1718$timeI[[1]]= as.numeric(froglia$year)
nep1718$timeI[[2]]=nep_pomo$year
nep1718$timeI[[3]]=MEDITS$year[MEDITS$year > 1993]
nep1718
# Plot your data
plotspict.data(nep1718) # Notice color coding of the month!
nep1718fit <- fit.spict(nep1718)
nep1718fit_diagn <- calc.osa.resid(nep1718fit)
plotspict.diagnostic(nep1718fit_diagn)
# Retrospective analysis
# Diagnostics, run it by taking away the last 4 years, one at a time
nep1718fit_retro <- retro(nep1718fit, nretroyear = 4)
# now plot it!
plotspict.retro(nep1718fit_retro)
save.image("~/stock_assessment_summer_school_2018/DAY2/day2.RData")
